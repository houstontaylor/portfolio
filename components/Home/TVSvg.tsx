import { useState } from 'react';
import styles from './TV.module.css';
import { motion } from 'framer-motion';

export default function TVSvg({ onTopDialClick, onBottomDialClick, mode, children }: {
  onTopDialClick: () => void;
  onBottomDialClick: () => void;
  mode: 'normal' | 'grayscale';
  children: React.ReactNode;
}) {
  const [topRotation, setTopRotation] = useState(0);
  const [bottomRotation, setBottomRotation] = useState(0);

  const handleTopClick = () => {
    setTopRotation((prev: number) => prev + 90);
    onTopDialClick();
  };

  const handleBottomClick = () => {
    setBottomRotation((prev: number) => prev + 90);
    onBottomDialClick();
  };

  return (
    <div style={{ position: 'relative', width: '100vw', height: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
      <svg 
        width="976" 
        height="832" 
        viewBox="0 0 976 832" 
        fill="none" 
        xmlns="http://www.w3.org/2000/svg"
        style={{
          width: '100vw',
          transform: 'translateY(-3vh)',
          transition: 'filter 0.2s ease',
          filter: mode === 'grayscale' ? 'grayscale(1)' : 'none'
        }}
      >
        <rect width="976" height="832"/>
        <g id="tv">
          <g id="tvBody">
            <g id="bg">
              <path d="M380.643 685.615L276.936 824.503L250.15 821.332L248.911 685.408C301.81 685.87 332.373 686.308 380.643 685.615Z" fill="#A0A63A"/>
              <path d="M732.665 649.976C772.788 643.612 794.159 639.644 831.333 632.24L885.553 743.514H855.606L732.665 649.976Z" fill="#A0A63A"/>
              <path d="M27.2549 306.5C34.7253 283.351 79.3737 268.882 114.569 266.607C405.235 247.811 604.462 251.552 866.614 264C911.762 266.144 931.173 290.24 939.8 320C966.612 412.495 957.448 487.936 939.8 579.5C934.754 605.68 909.46 618.464 871.749 626.132C608.643 679.636 439.529 694.069 179.406 683.362C144.948 681.944 103.425 679.811 90.0276 658.5C27.2416 558.627 -0.649603 392.97 27.2549 306.5Z" fill="#C8D06D"/>
              <path d="M614.247 222.236C572.143 221.019 532.47 222.55 457.563 222.55C383.965 224.301 340.917 225.759 304.33 227.227C322.68 209.224 388.497 186.424 439.727 189.922C490.958 193.421 568.515 212.56 614.247 222.236Z" fill="#C8D06D"/>
              <path d="M350.58 720.13L278.003 816.401L267.686 814.257L276.936 714.649C306.109 716.079 323.541 718.224 350.58 720.13Z" fill="#C8D06D"/>
              <path d="M805.249 681.526C819.48 678.666 827.307 677.713 842.961 675.092L861.461 711.313L876.403 739.908L805.249 681.526Z" fill="#C8D06D"/>
            </g>
            <g id="body">
              <mask id="path-2-inside-1_0_1" fill="white">
                <path d="M895.857 263.438C907.759 264.652 918.532 270.996 924.776 281.201C980.889 372.909 984.641 487.942 939.473 610.354C935.488 621.154 926.99 629.639 916.086 633.327C749.367 689.716 298.647 734.706 104.937 683.271C97.4571 681.285 90.9479 677.196 86.441 670.905C33.7272 597.316 -31.2986 360.358 30.979 280.392C35.3374 274.796 41.5954 271.443 48.5053 269.841C233.01 227.041 714.19 244.897 895.857 263.438Z"/>
              </mask>
              <path d="M933.165 276.068C927.573 279.49 921.98 282.912 916.387 286.334C935.905 322.32 947.483 361.814 951.373 401.876C958.05 470.009 943.496 538.653 918.136 602.481C916.223 606.908 912.568 609.978 908.555 611.061C829.912 634.525 744.376 647.008 660.238 658.213C477.626 679.204 286.121 696.123 111.3 659.307C108.514 658.564 107.392 657.656 106.502 656.535C47.0403 553.993 -1.02666 393.799 48.1296 293.749C48.7228 292.879 50.0934 291.674 53.3744 290.831C295.493 247.358 553.284 258.652 804.059 267.862C834.405 269.442 864.902 271.305 894.797 273.82C903.545 274.469 911.788 279.103 916.387 286.334C921.98 282.912 927.573 279.49 933.165 276.068C925.595 263.112 911.495 254.638 896.916 253.055C866.747 249.475 836.142 246.595 805.679 244.023C552.7 226.92 300.39 207.837 43.6361 248.85C33.4105 251.08 21.7801 256.814 13.8285 267.035C-33.5805 340.501 -17.1236 415.291 -7.05142 484.205C7.20754 553.738 24.8928 620.518 66.3801 685.275C74.2676 696.563 86.7392 704.179 98.5742 707.236C290.5 749.196 479.403 731.259 666.92 710.238C753.132 698.663 839.017 684.688 923.617 655.593C941.121 649.538 955.015 635.061 960.81 618.227C984.895 548.134 996.088 471.512 982.529 397.437C974.644 353.929 957.85 312.066 933.165 276.068ZM916.387 286.334L933.165 276.068L916.387 286.334Z" fill="#A0A63A" mask="url(#path-2-inside-1_0_1)"/>
            </g>
            <g id="legOutline">
              <mask id="path-4-inside-2_0_1" fill="white">
                <path d="M772.162 674.853C812.286 668.489 811.123 668.198 848.297 660.793L903.796 752.061L867.152 749.439L772.162 674.853Z"/>
                <path d="M376.55 710.597L284.407 831.89L254.878 828.553L260.214 703.448C313.007 705.742 328.294 709.564 376.55 710.597Z"/>
              </mask>
              <path d="M772.162 674.853C812.286 668.489 811.123 668.198 848.297 660.793L903.796 752.061L867.152 749.439L772.162 674.853Z" stroke="black" strokeWidth="10.0869" mask="url(#path-4-inside-2_0_1)"/>
              <path d="M376.55 710.597L284.407 831.89L254.878 828.553L260.214 703.448C313.007 705.742 328.294 709.564 376.55 710.597Z" stroke="black" strokeWidth="10.0869" mask="url(#path-4-inside-2_0_1)"/>
            </g>
            <g id="outline">
              <mask id="path-5-inside-3_0_1" fill="white">
                <path d="M7.97641 311.452C15.4468 288.303 32.4002 257.013 67.5956 254.738C261.133 226.619 627.427 226.475 895.258 253.07C940.406 255.213 955.65 290.032 964.277 319.792C989.161 405.635 969.268 492.391 952.17 577.621C949.574 590.564 943.969 602.999 934.096 611.763C913.165 630.342 896.824 632.07 865.73 638.393C554.724 698.537 336.349 713.933 175.137 683.901C137.476 676.885 104.877 671.993 92.2932 651.976C29.5072 552.103 -19.9281 397.922 7.97641 311.452Z"/>
              </mask>
              <path d="M7.97641 311.452C15.4468 288.303 32.4002 257.013 67.5956 254.738C261.133 226.619 627.427 226.475 895.258 253.07C940.406 255.213 955.65 290.032 964.277 319.792C989.161 405.635 969.268 492.391 952.17 577.621C949.574 590.564 943.969 602.999 934.096 611.763C913.165 630.342 896.824 632.07 865.73 638.393C554.724 698.537 336.349 713.933 175.137 683.901C137.476 676.885 104.877 671.993 92.2932 651.976C29.5072 552.103 -19.9281 397.922 7.97641 311.452Z" stroke="black" strokeWidth="10.0869" mask="url(#path-5-inside-3_0_1)"/>
            </g>
            <g id="top">
              <mask id="path-6-outside-4_0_1" maskUnits="userSpaceOnUse" x="301.33" y="184.535" width="314" height="48" fill="black">
                <rect fill="white" x="301.33" y="184.535" width="314" height="48"/>
                <path d="M614.247 222.235C572.143 221.018 532.471 222.549 457.563 222.549C383.965 224.299 340.917 225.758 304.33 227.226C337.267 208.27 386.718 188.968 437.949 190.636C489.179 192.304 566.381 213.751 614.247 222.235Z"/>
              </mask>
              <path d="M614.247 222.235C572.143 221.018 532.471 222.549 457.563 222.549C383.965 224.299 340.917 225.758 304.33 227.226C337.267 208.27 386.718 188.968 437.949 190.636C489.179 192.304 566.381 213.751 614.247 222.235Z" stroke="black" strokeWidth="10.0869" mask="url(#path-6-outside-4_0_1)"/>
            </g>
            <g id="antennaBulbs">
              <mask id="path-7-inside-5_0_1" fill="white">
                <path d="M734.968 90.6436C734.968 96.7478 727.706 101.696 718.747 101.696C709.788 101.696 702.525 96.7478 702.525 90.6436C702.525 84.5393 709.788 79.5908 718.747 79.5908C727.706 79.5908 734.968 84.5393 734.968 90.6436Z"/>
                <path d="M292.647 12.1907C292.647 18.9234 284.637 24.3814 274.756 24.3814C264.874 24.3814 256.864 18.9234 256.864 12.1907C256.864 5.45796 264.874 0 274.756 0C284.637 0 292.647 5.45796 292.647 12.1907Z"/>
              </mask>
              <path d="M734.968 90.6436C734.968 96.7478 727.706 101.696 718.747 101.696C709.788 101.696 702.525 96.7478 702.525 90.6436C702.525 84.5393 709.788 79.5908 718.747 79.5908C727.706 79.5908 734.968 84.5393 734.968 90.6436Z" stroke="black" strokeWidth="8.74616" mask="url(#path-7-inside-5_0_1)"/>
              <path d="M292.647 12.1907C292.647 18.9234 284.637 24.3814 274.756 24.3814C264.874 24.3814 256.864 18.9234 256.864 12.1907C256.864 5.45796 264.874 0 274.756 0C284.637 0 292.647 5.45796 292.647 12.1907Z" stroke="black" strokeWidth="8.74616" mask="url(#path-7-inside-5_0_1)"/>
            </g>
            <g id="antenna">
              <mask id="path-8-inside-6_0_1" fill="white">
                <path d="M279.074 27.4807L371.618 189.472C349.248 195.66 358.491 194.117 342.312 198.977L279.074 27.4807Z"/>
                <path d="M702.526 101.696L569.956 203.981C553.175 198.923 547.861 195.926 538.631 193.49L702.526 101.696Z"/>
              </mask>
              <path d="M279.074 27.4807L371.618 189.472C349.248 195.66 358.491 194.117 342.312 198.977L279.074 27.4807Z" fill="#C8D06D"/>
              <path d="M702.526 101.696L569.956 203.981C553.175 198.923 547.861 195.926 538.631 193.49L702.526 101.696Z" fill="#C8D06D"/>
              <path d="M279.074 27.4807L371.618 189.472C349.248 195.66 358.491 194.117 342.312 198.977L279.074 27.4807Z" stroke="black" strokeWidth="7.92975" mask="url(#path-8-inside-6_0_1)"/>
              <path d="M702.526 101.696L569.956 203.981C553.175 198.923 547.861 195.926 538.631 193.49L702.526 101.696Z" stroke="black" strokeWidth="7.92975" mask="url(#path-8-inside-6_0_1)"/>
            </g>
            <g id="grate">
              <mask id="path-9-inside-7_0_1" fill="white">
                <path d="M25.2595 327.418L175.749 325.512L182.153 335.997L20.6345 343.86L25.2595 327.418Z"/>
                <path d="M18.5 347.673L187.489 340.763L191.047 353.869L18.5 356.252V347.673Z"/>
                <path d="M19.923 360.541L190.691 358.396V369.835L22.7691 376.507L19.923 360.541Z"/>
                <path d="M27.0376 382.464L191.402 374.601L193.536 391.758H27.0376V382.464Z"/>
                <path d="M27.8747 396.047L190.691 399.86L184.999 409.29H32.7305L27.8747 396.047Z"/>
              </mask>
              <path d="M25.2595 327.418L175.749 325.512L182.153 335.997L20.6345 343.86L25.2595 327.418Z" fill="#F6A393"/>
              <path d="M18.5 347.673L187.489 340.763L191.047 353.869L18.5 356.252V347.673Z" fill="#F6A393"/>
              <path d="M19.923 360.541L190.691 358.396V369.835L22.7691 376.507L19.923 360.541Z" fill="#F6A393"/>
              <path d="M27.0376 382.464L191.402 374.601L193.536 391.758H27.0376V382.464Z" fill="#F6A393"/>
              <path d="M27.8747 396.047L190.691 399.86L184.999 409.29H32.7305L27.8747 396.047Z" fill="#F6A393"/>
              <path d="M25.2595 327.418L175.749 325.512L182.153 335.997L20.6345 343.86L25.2595 327.418Z" stroke="black" strokeWidth="5.04345" mask="url(#path-9-inside-7_0_1)"/>
              <path d="M18.5 347.673L187.489 340.763L191.047 353.869L18.5 356.252V347.673Z" stroke="black" strokeWidth="5.04345" mask="url(#path-9-inside-7_0_1)"/>
              <path d="M19.923 360.541L190.691 358.396V369.835L22.7691 376.507L19.923 360.541Z" stroke="black" strokeWidth="5.04345" mask="url(#path-9-inside-7_0_1)"/>
              <path d="M27.0376 382.464L191.402 374.601L193.536 391.758H27.0376V382.464Z" stroke="black" strokeWidth="5.04345" mask="url(#path-9-inside-7_0_1)"/>
              <path d="M27.8747 396.047L190.691 399.86L184.999 409.29H32.7305L27.8747 396.047Z" stroke="black" strokeWidth="5.04345" mask="url(#path-9-inside-7_0_1)"/>
            </g>
          </g>
          <g id="screen">
            <path id="screen_2" d="M222.586 341.782C226.889 320.641 244.326 305.237 265.992 303.155C442.28 286.211 722.264 292.888 840.77 307.796C859.145 310.108 874.86 322.433 881.586 339.789C912.615 419.85 909.989 478.794 879.635 560.765C873.897 576.258 860.591 587.52 844.358 591.269C651.992 635.699 513.483 639.642 307.812 646.156C287.555 646.798 267.818 636.26 258.12 618.1C205.553 519.658 202.766 439.164 222.586 341.782Z" fill="#EEE0B3"/>
            <g id="shadow">
              <mask id="path-11-inside-8_0_1" fill="white">
                <path d="M301.712 645.68C286.558 645.617 272.186 638.491 263.687 625.945C206.692 541.808 184.901 452.769 216.05 331.417C220.924 312.431 237.825 299.14 257.361 297.536C501.777 277.464 610.851 279.329 842.061 301.293C862.218 303.208 879.14 317.533 884.322 337.107C908.655 429.026 918.634 475.167 885.234 565.927C879.61 581.211 866.015 592.126 850.013 595.151C633.919 636.012 531.563 646.629 301.712 645.68Z"/>
              </mask>
              <path d="M258.989 629.127C262.121 627.006 265.253 624.884 268.384 622.763C251.964 596.298 238.189 568.427 228.767 539.302C206.697 473.077 211.069 401.843 229.608 334.898C232.903 322.362 245.247 312.905 258.56 312.137C293.959 309.553 329.28 307.031 364.429 304.797C523.414 292.993 681.727 299.947 840.732 315.277C854.699 316.333 867.479 326.967 871.016 340.629C893.666 415.691 903.818 489.682 873.672 561.673C869.907 572.552 859.63 581.122 847.791 583.399C683.985 617.426 518.943 638.232 351.618 638.797C334.93 639.074 318.553 639.274 301.737 639.42C288.781 639.639 275.752 633.44 268.384 622.763C265.253 624.884 262.121 627.006 258.989 629.127C268.222 643.306 284.939 651.788 301.686 651.94C318.529 652.224 334.941 652.445 351.677 652.582C519.147 656.258 687.738 638.488 852.235 606.903C871.796 603.472 889.69 589.511 896.796 570.182C930.164 496.334 919.762 406.8 897.628 333.584C891.483 308.886 868.84 289.537 843.389 287.308C684.472 270.491 522.605 262.66 362.51 274.597C327.106 276.848 291.632 279.702 256.162 282.935C231.503 284.817 208.297 303.116 202.491 327.937C184.826 398.697 183.677 476.906 211.689 545.466C223.626 575.605 240.078 603.477 258.989 629.127ZM268.384 622.763L258.989 629.127L268.384 622.763Z" fill="#A0A63A" mask="url(#path-11-inside-8_0_1)"/>
            </g>
            <g id="outline_2">
              <mask id="path-13-outside-9_0_1" maskUnits="userSpaceOnUse" x="202.556" y="274.517" width="705.338" height="365.775" fill="black">
                <rect fill="white" x="202.556" y="274.517" width="705.338" height="365.775"/>
                <path d="M223.363 344.429C226.71 323.079 244.288 307.691 265.952 305.602C436.263 289.181 703.921 294.392 828.978 308.115C853.894 310.849 872.714 331.489 876.384 356.205C887.378 430.246 901.499 477.998 876.962 552.941C871.633 569.216 857.47 580.647 840.537 584.044C648.457 622.583 514.277 628.465 313.4 628.962C293.246 629.012 273.966 618.039 264.91 599.73C228.823 526.766 208.32 440.399 223.363 344.429Z"/>
              </mask>
              <path d="M223.363 344.429C226.71 323.079 244.288 307.691 265.952 305.602C436.263 289.181 703.921 294.392 828.978 308.115C853.894 310.849 872.714 331.489 876.384 356.205C887.378 430.246 901.499 477.998 876.962 552.941C871.633 569.216 857.47 580.647 840.537 584.044C648.457 622.583 514.277 628.465 313.4 628.962C293.246 629.012 273.966 618.039 264.91 599.73C228.823 526.766 208.32 440.399 223.363 344.429Z" stroke="black" strokeWidth="10.0869" mask="url(#path-13-outside-9_0_1)"/>
            </g>
          </g>
          
          {/* Dials */}
          <motion.g 
            onClick={handleTopClick}
            style={{ 
              cursor: 'pointer',
              transformOrigin: '120.772px 489.272px',
              transform: `rotate(${topRotation}deg)`,
              transition: 'transform 0.3s ease-out'
            }}
          >
            <ellipse cx="120.772" cy="489.272" rx="43.6181" ry="35.7443" fill="#007F7E"/>
            <path d="M123.68 447.47C146.869 447.47 164.776 462.791 164.776 480.693C164.776 498.595 146.869 513.916 123.68 513.916C100.49 513.916 82.583 498.595 82.583 480.693C82.5831 462.791 100.49 447.47 123.68 447.47Z" stroke="black" strokeWidth="5.04345"/>
            <rect width="61.8941" height="14.3785" transform="matrix(0.310782 -0.950481 0.97673 0.21447 111.319 498.059)" fill="#87C9BF" stroke="black" strokeWidth="5.04345"/>
          </motion.g>
          
          <motion.g 
            onClick={handleBottomClick}
            style={{ 
              cursor: 'pointer',
              transformOrigin: '153.079px 585.02px',
              transform: `rotate(${bottomRotation}deg)`,
              transition: 'transform 0.3s ease-out'
            }}
          >
            <ellipse cx="153.079" cy="585.02" rx="43.6181" ry="35.7443" fill="#007F7E"/>
            <path d="M165.292 549.891C188.481 549.891 206.388 565.211 206.388 583.113C206.388 601.015 188.481 616.336 165.292 616.336C142.102 616.336 124.195 601.015 124.195 583.113C124.195 565.211 142.102 549.891 165.292 549.891Z" stroke="black" strokeWidth="5.04345"/>
            <rect width="66.2561" height="13.4278" transform="matrix(-0.739558 -0.673093 0.804662 -0.593733 181.142 601.368)" fill="#87C9BF" stroke="black" strokeWidth="5.04345"/>
          </motion.g>
        </g>
        <defs>
          <filter id="filter0_d_0_1" x="18.5" y="325.512" width="175.036" height="86.3005" filterUnits="userSpaceOnUse" colorInterpolationFilters="sRGB">
            <feFlood floodOpacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="2.52172"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0.627451 0 0 0 0 0.65098 0 0 0 0 0.227451 0 0 0 1 0"/>
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_0_1"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_0_1" result="shape"/>
          </filter>
        </defs>
      </svg>

      {/* Screen Content Overlay */}
      <div className={styles.screenContent}>
        {children}
      </div>
    </div>
  );
}